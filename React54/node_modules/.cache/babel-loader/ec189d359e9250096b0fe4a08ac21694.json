{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\Frontend\\\\React54\\\\src\\\\pages\\\\ProfileUser.jsx\";\nimport React, { Component, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { getProFileAction } from '../redux/actions/MemberManageAction';\nimport moment from 'moment';\nimport { Icon, Table, Tag, Button, Modal, Tooltip, Checkbox, Spin, Switch } from 'antd';\nimport { cancelTicketAction, huyVeAction } from '../redux/actions/BookingManageAction';\nimport { getSettingAction } from '../redux/actions/SettingAction';\nimport { showMessageAlert } from '../templates/SweetAlert';\nimport Item from 'antd/lib/list/Item';\nconst {\n  confirm\n} = Modal;\n\nclass ProfileUser extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleOpenList = record => {\n      console.log('record', record);\n      this.setState({\n        visible: !this.state.visible,\n        listTicket: record\n      });\n    };\n\n    this.handleOk = e => {\n      console.log(e);\n      let danhSachVeHuy = this.state.danhSachVeHuy;\n      let danhSachTemp = [];\n\n      if (danhSachVeHuy.length === 0) {\n        showMessageAlert('Warning', \"Please choose cancel tickets\", 'warning');\n      } else {\n        danhSachVeHuy.map((veHuy, index) => {\n          danhSachTemp.push({\n            MaVe: veHuy.MaVe,\n            GiaVe: veHuy.GiaVe\n          });\n        });\n        let mucHoanTra = this.props.setting.map(item => {\n          return item.Setting;\n        });\n        let objectVeHuy = {\n          MucHoanTra: parseInt(mucHoanTra),\n          //Lấy mức hoàn trả\n          DanhSachVeHuy: danhSachVeHuy\n        };\n        this.props.cancelTicket(objectVeHuy); // console.log(\"danhSachVeHuy\", danhSachVeHuy, this.props.setting);            \n      }\n    };\n\n    this.handleCancel = e => {\n      console.log(e);\n      this.setState({\n        visible: false\n      });\n    };\n\n    this.checkConditionCancel = duration => {\n      // if (duration > 0 && duration <= 1) {\n      //     showMessageAlert('Notification', 'Bạn không thể hủy vé. Lý do: cận ngày chiếu!', 'warning')\n      // }\n      // Nếu ngày hủy cách ngày chiếu > 5 ngày thì mức hoàn tiền 50%\n      if (duration > 5) {\n        this.props.getSetting('HT2');\n      } // Nếu ngày hủy cách ngày chiếu từ 2 đến 5 ngày thì mức hoàn tiền 20%\n      else if (duration <= 5 && duration > 1) {\n          this.props.getSetting('HT1');\n        }\n    };\n\n    this.cancelTicket = (duration, record) => {\n      // console.log(\"record Huy\", record);\n      console.log(\"duration\", duration);\n      this.checkConditionCancel(duration);\n      const veDuocChon = {\n        MaVe: record.MaVe,\n        TenGhe: record.TenGhe,\n        GiaVe: record.GiaVe\n      };\n      let array = this.state.danhSachVeHuy;\n      let index = array.findIndex(ve => ve.MaVe === veDuocChon.MaVe);\n\n      if (index !== -1) {\n        array.splice(index, 1);\n      } else {\n        array.push(veDuocChon); // this.setState({\n        //     classTrangThaiVe: 'veDangChon'\n        // })\n      }\n\n      this.setState({\n        danhSachVeHuy: array\n      }, () => {\n        console.log(this.state.danhSachVeHuy);\n      });\n    };\n\n    this.showDeleteConfirm = async (maThanhToan, mucHoanTien) => {\n      confirm({\n        title: 'Are you sure delete this task?',\n        content: 'Some descriptions',\n        okText: 'Yes',\n        okType: 'danger',\n        cancelText: 'No',\n        onOk: async () => {\n          let objectHuyVe = {\n            maThanhToan: maThanhToan,\n            mucHoanTien: mucHoanTien\n          };\n          this.props.cancelTicket(objectHuyVe);\n        },\n\n        onCancel() {\n          console.log('Cancel');\n        }\n\n      });\n    };\n\n    this.state = {\n      taiKhoan: this.props.match.params.taiKhoan,\n      visible: false,\n      listTicket: [],\n      ngayChieu: '',\n      setting: [],\n      dangChon: false,\n      danhSachVeHuy: [],\n      durationHuy: 0,\n      classTrangThaiVe: ''\n    };\n  }\n\n  componentDidMount() {\n    this.props.getProfile(this.state.taiKhoan);\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    // console.log(\"nextProps\", nextProps);\n    // console.log(\"prevState\", prevState);\n    if (prevState.setting != nextProps.setting) {\n      return { ...prevState,\n        setting: nextProps.setting\n      };\n    }\n\n    return null;\n  }\n\n  render() {\n    const profileInfor = this.props.profileInfor;\n    const columns = [{\n      title: 'Mã Thanh Toán',\n      dataIndex: 'MaThanhToan',\n      key: 'MaThanhToan ',\n      align: 'center'\n    }, {\n      title: 'Cụm Rạp',\n      dataIndex: 'TenCumRap',\n      key: 'TenCumRap ',\n      align: 'center'\n    }, {\n      title: 'Phim',\n      dataIndex: 'TenPhim',\n      key: 'TenPhim',\n      align: 'center'\n    }, {\n      title: 'Ngày Chiếu',\n      dataIndex: 'NgayChieuGioChieu',\n      key: 'NgayChieu',\n      align: 'center',\n      render: NgayChieuGioChieu => {\n        let NgayChieu = new Date(NgayChieuGioChieu);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: NgayChieu.toLocaleDateString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 25\n        }, this);\n      }\n    }, {\n      title: 'Suất Chiếu',\n      dataIndex: 'NgayChieuGioChieu',\n      key: 'GioChieu',\n      align: 'center',\n      render: NgayChieuGioChieu => {\n        let NgayChieu = new Date(NgayChieuGioChieu);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: NgayChieu.toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 25\n        }, this);\n      }\n    }, {\n      title: 'Ngày Đặt',\n      dataIndex: 'NgayDat',\n      key: 'NgayDat',\n      align: 'center',\n      render: NgayDat => {\n        let Ngay = new Date(NgayDat);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: Ngay.toLocaleDateString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 25\n        }, this);\n      }\n    }, {\n      title: 'Giờ Đặt',\n      dataIndex: 'NgayDat',\n      key: 'GioDat',\n      align: 'center',\n      render: NgayDat => {\n        let GioDat = new Date(NgayDat);\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          children: GioDat.toLocaleTimeString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 25\n        }, this);\n      }\n    }];\n    const data = this.props.profileInfor.ThongTinDatVe;\n    const columnsExpended = [{\n      title: 'Mã Vé',\n      dataIndex: 'MaVe',\n      key: 'MaVe',\n      align: 'center'\n    }, {\n      title: 'Mã Ghế',\n      dataIndex: 'MaGhe',\n      key: 'MaGhe',\n      align: 'center'\n    }, {\n      title: 'Tên Ghế',\n      dataIndex: 'TenGhe',\n      key: 'TenGhe',\n      align: 'center'\n    }, {\n      title: 'Giá Vé',\n      dataIndex: 'GiaVe',\n      key: 'GiaVe',\n      align: 'center'\n    }, {\n      title: 'Chọn Hủy',\n      key: 'TrangThaiHuy',\n      align: 'center',\n      render: record => {\n        let thoiGianChieu = new Date(this.state.listTicket.NgayChieuGioChieu).toLocaleDateString();\n        let now = moment(new Date()).format(\"DD.MM.YYYY\"); //todays date\n\n        let startDate = moment(thoiGianChieu, \"DD.MM.YYYY\");\n        let endDate = moment(now, \"DD.MM.YYYY\");\n        const duration = startDate.diff(endDate, 'days');\n        console.log(duration); // disabled={duration <= 0 || record.TrangThaiHuy} onClick={() => { this.cancelTicket(duration, record.MaThanhToan) }}\n\n        if (record.TrangThaiHuy) {}\n\n        console.log(\"Switch\", record);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(Switch, {\n            disabled: record.TrangThaiHuy || duration <= 1,\n            onClick: () => this.cancelTicket(duration, record)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 25\n        }, this);\n      }\n    }];\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile__bg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container d-flex justify-content-between\",\n          style: {\n            paddingTop: \"170px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile__content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"border__bottom pb-4\",\n              style: {\n                textAlign: \"center\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: process.env.PUBLIC_URL + \"/images/uploads/userava.png\",\n                alt: \"\",\n                width: 100\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4\",\n                children: [/*#__PURE__*/_jsxDEV(Tag, {\n                  color: \"gold\",\n                  style: {\n                    width: \"65px\",\n                    fontSize: \"14px\",\n                    fontWeight: \"bold\"\n                  },\n                  children: \"Edit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(Tag, {\n                  color: \"gold\",\n                  style: {\n                    width: \"65px\",\n                    fontSize: \"14px\",\n                    fontWeight: \"bold\"\n                  },\n                  children: \"Logout\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between my-4 border__bottom\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"span__title__icon color-text\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  type: \"smile\",\n                  rotate: 180\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\\xA0Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profileInfor.HoTen\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between border__bottom my-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"span__title__icon color-text\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  type: \"mail\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\\xA0Email\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profileInfor.Email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between border__bottom my-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"span__title__icon color-text\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  type: \"phone\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 279,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\\xA0Phone\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 278,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profileInfor.SoDT\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between border__bottom my-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"span__title__icon color-text\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  type: \"crown\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 286,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\\xA0Membership\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: profileInfor.LoaiNguoiDung\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-flex justify-content-between border__bottom my-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"span__title__icon color-text\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  type: \"money-collect\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\\xA0Amount ticket\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"color-text\",\n                children: profileInfor.SoLuongVeDaMua\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"history__content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"\",\n              style: {\n                float: \"right\",\n                marginBottom: \"10px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(Tag, {\n                color: \"#ed7532\",\n                style: {\n                  fontSize: \"16px\",\n                  padding: \"5px\"\n                },\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"span__title__icon\",\n                  children: [/*#__PURE__*/_jsxDEV(Icon, {\n                    type: \"clock-circle\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 304,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\xA0\\xA0History booking\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 37\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 303,\n                  columnNumber: 100\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Table, {\n              bordered: true,\n              pagination: {\n                defaultPageSize: 3\n              },\n              rowKey: record => record.MaThanhToan,\n              className: \"components-table-demo-nested\",\n              columns: columns,\n              onRow: record => ({\n                onDoubleClick: () => this.handleOpenList(record)\n              }) // expandedRowRender={(record) =>\n              //     <Table rowKey={(record) => record.MaVe} columns={columnsExpended} dataSource={record.DanhSachGhe} pagination={false} />\n              // }\n              ,\n              dataSource: data\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Modal, {\n              className: \"modal__list__ticket\",\n              title: \"List ticket booked\",\n              visible: this.state.visible // footer={false}\n              ,\n              okText: \"Send request cancel\",\n              cancelText: \"Exit\",\n              onOk: this.handleOk,\n              onCancel: this.handleCancel,\n              children: /*#__PURE__*/_jsxDEV(Table, {\n                size: \"small\",\n                rowKey: record => record.MaVe,\n                columns: columnsExpended,\n                dataSource: this.state.listTicket.DanhSachGhe,\n                pagination: false\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    profileInfor: state.MemberManageReducer.profileInfor,\n    setting: state.SettingReducer.setting,\n    danhSachVeDuocChon: state.BookingManageReducer.danhSachVeDuocChon\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getProfile: taiKhoan => {\n      dispatch(getProFileAction(taiKhoan));\n    },\n    cancelTicket: objectHuyVe => {\n      dispatch(cancelTicketAction(objectHuyVe));\n    },\n    chonVeHuy: veDangChon => {\n      dispatch(huyVeAction(veDangChon));\n    },\n    getSetting: setting => {\n      dispatch(getSettingAction(setting));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileUser);","map":{"version":3,"sources":["C:/Users/Acer/Desktop/Frontend/React54/src/pages/ProfileUser.jsx"],"names":["React","Component","Fragment","connect","getProFileAction","moment","Icon","Table","Tag","Button","Modal","Tooltip","Checkbox","Spin","Switch","cancelTicketAction","huyVeAction","getSettingAction","showMessageAlert","Item","confirm","ProfileUser","constructor","props","handleOpenList","record","console","log","setState","visible","state","listTicket","handleOk","e","danhSachVeHuy","danhSachTemp","length","map","veHuy","index","push","MaVe","GiaVe","mucHoanTra","setting","item","Setting","objectVeHuy","MucHoanTra","parseInt","DanhSachVeHuy","cancelTicket","handleCancel","checkConditionCancel","duration","getSetting","veDuocChon","TenGhe","array","findIndex","ve","splice","showDeleteConfirm","maThanhToan","mucHoanTien","title","content","okText","okType","cancelText","onOk","objectHuyVe","onCancel","taiKhoan","match","params","ngayChieu","dangChon","durationHuy","classTrangThaiVe","componentDidMount","getProfile","getDerivedStateFromProps","nextProps","prevState","render","profileInfor","columns","dataIndex","key","align","NgayChieuGioChieu","NgayChieu","Date","toLocaleDateString","toLocaleTimeString","NgayDat","Ngay","GioDat","data","ThongTinDatVe","columnsExpended","thoiGianChieu","now","format","startDate","endDate","diff","TrangThaiHuy","paddingTop","textAlign","process","env","PUBLIC_URL","width","fontSize","fontWeight","HoTen","Email","SoDT","LoaiNguoiDung","SoLuongVeDaMua","float","marginBottom","padding","defaultPageSize","MaThanhToan","onDoubleClick","DanhSachGhe","mapStateToProps","MemberManageReducer","SettingReducer","danhSachVeDuocChon","BookingManageReducer","mapDispatchToProps","dispatch","chonVeHuy","veDangChon"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport { connect } from 'react-redux'\nimport { getProFileAction } from '../redux/actions/MemberManageAction'\nimport moment from 'moment'\nimport { Icon, Table, Tag, Button, Modal, Tooltip, Checkbox, Spin, Switch } from 'antd'\nimport { cancelTicketAction, huyVeAction } from '../redux/actions/BookingManageAction'\nimport { getSettingAction } from '../redux/actions/SettingAction'\nimport { showMessageAlert } from '../templates/SweetAlert'\nimport Item from 'antd/lib/list/Item'\n\nconst { confirm } = Modal;\n\nclass ProfileUser extends Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            taiKhoan: this.props.match.params.taiKhoan,\n            visible: false,\n            listTicket: [],\n            ngayChieu: '',\n            setting: [],\n            dangChon: false,\n            danhSachVeHuy: [],\n            durationHuy: 0,\n            classTrangThaiVe: ''\n        }\n    }\n\n    componentDidMount() {\n        this.props.getProfile(this.state.taiKhoan);\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState) {\n        // console.log(\"nextProps\", nextProps);\n        // console.log(\"prevState\", prevState);\n        if (prevState.setting != nextProps.setting) {\n            return {\n                ...prevState, setting: nextProps.setting\n            }\n        }\n        return null\n    }\n\n\n    handleOpenList = (record) => {\n        console.log('record', record);\n        this.setState({\n            visible: !this.state.visible,\n            listTicket: record,\n        })\n    }\n\n    handleOk = e => {\n        console.log(e);\n        let danhSachVeHuy = this.state.danhSachVeHuy;\n        let danhSachTemp = [];\n        if(danhSachVeHuy.length === 0){\n            showMessageAlert('Warning', \"Please choose cancel tickets\", 'warning')\n        }\n        else{\n            danhSachVeHuy.map((veHuy, index) => {\n                danhSachTemp.push({\n                    MaVe: veHuy.MaVe,\n                    GiaVe: veHuy.GiaVe,\n                })\n            })\n            let mucHoanTra = this.props.setting.map(item => {\n                return item.Setting\n            })\n            let objectVeHuy ={\n                MucHoanTra: parseInt(mucHoanTra), //Lấy mức hoàn trả\n                DanhSachVeHuy: danhSachVeHuy\n            }\n            this.props.cancelTicket(objectVeHuy)\n            // console.log(\"danhSachVeHuy\", danhSachVeHuy, this.props.setting);            \n        }\n    };\n\n    handleCancel = e => {\n        console.log(e);\n        this.setState({\n            visible: false,\n        });\n    };\n\n    checkConditionCancel = (duration) => {\n        // if (duration > 0 && duration <= 1) {\n        //     showMessageAlert('Notification', 'Bạn không thể hủy vé. Lý do: cận ngày chiếu!', 'warning')\n        // }\n\n        // Nếu ngày hủy cách ngày chiếu > 5 ngày thì mức hoàn tiền 50%\n        if (duration > 5) {\n            this.props.getSetting('HT2');\n        }\n        // Nếu ngày hủy cách ngày chiếu từ 2 đến 5 ngày thì mức hoàn tiền 20%\n        else if (duration <= 5 && duration > 1) {\n            this.props.getSetting('HT1');\n        }\n    }\n\n    cancelTicket = (duration, record) => {\n        // console.log(\"record Huy\", record);\n        console.log(\"duration\", duration);\n        this.checkConditionCancel(duration);\n        const veDuocChon = {\n            MaVe: record.MaVe,\n            TenGhe: record.TenGhe,\n            GiaVe: record.GiaVe,        \n        } \n        \n        let array = this.state.danhSachVeHuy;\n        let index = array.findIndex(ve => ve.MaVe === veDuocChon.MaVe);\n        if (index !== -1) {\n            array.splice(index, 1)            \n        }\n        else {  \n            array.push(veDuocChon);\n            // this.setState({\n            //     classTrangThaiVe: 'veDangChon'\n            // })\n        }\n        this.setState({\n            danhSachVeHuy: array\n        }, () => {\n            console.log(this.state.danhSachVeHuy);\n        })\n    }\n\n    // cancelTicket = (duration, maThanhToan) => {\n    //     // alert(duration + ' ' + maThanhToan + ' ' + this.state.setting)\n    //     if (duration > 0 && duration <= 1) {\n    //         showMessageAlert('Notification', 'Bạn không thể hủy vé. Lý do: cận ngày chiếu!', 'warning')\n    //     }\n    //     else if (duration >= 5) {\n    //         this.props.getSetting('HT2');\n    //     }\n    //     else if (duration < 5 && duration > 1) {\n    //         this.props.getSetting('HT1');\n    //     }\n    //     let mucHoanTien = 0;\n    //     setTimeout(() => {\n    //         this.state.setting.map(st => {\n    //             mucHoanTien = st.Setting\n    //         })\n    //         this.showDeleteConfirm(maThanhToan, mucHoanTien);\n    //     }, 2000);\n\n    // }\n\n    showDeleteConfirm = async (maThanhToan, mucHoanTien) => {\n\n        confirm({\n            title: 'Are you sure delete this task?',\n            content: 'Some descriptions',\n            okText: 'Yes',\n            okType: 'danger',\n            cancelText: 'No',\n            onOk: async () => {\n                let objectHuyVe = {\n                    maThanhToan: maThanhToan,\n                    mucHoanTien: mucHoanTien\n                }\n                this.props.cancelTicket(objectHuyVe)\n            },\n            onCancel() {\n                console.log('Cancel');\n            },\n        });\n    }\n\n    render() {\n        const profileInfor = this.props.profileInfor;\n        const columns = [\n            { title: 'Mã Thanh Toán', dataIndex: 'MaThanhToan', key: 'MaThanhToan ', align: 'center' },\n            { title: 'Cụm Rạp', dataIndex: 'TenCumRap', key: 'TenCumRap ', align: 'center', },\n            { title: 'Phim', dataIndex: 'TenPhim', key: 'TenPhim', align: 'center' },\n            {\n                title: 'Ngày Chiếu', dataIndex: 'NgayChieuGioChieu', key: 'NgayChieu', align: 'center',\n                render: (NgayChieuGioChieu) => {\n                    let NgayChieu = new Date(NgayChieuGioChieu)\n                    return (\n                        <span>{NgayChieu.toLocaleDateString()}</span>\n                    )\n                }\n            },\n            {\n                title: 'Suất Chiếu', dataIndex: 'NgayChieuGioChieu', key: 'GioChieu', align: 'center',\n                render: (NgayChieuGioChieu) => {\n                    let NgayChieu = new Date(NgayChieuGioChieu)\n                    return (\n                        <span>{NgayChieu.toLocaleTimeString()}</span>\n                    )\n                }\n            },\n            {\n                title: 'Ngày Đặt', dataIndex: 'NgayDat', key: 'NgayDat', align: 'center',\n                render: (NgayDat) => {\n                    let Ngay = new Date(NgayDat)\n                    return (\n                        <span>{Ngay.toLocaleDateString()}</span>\n                    )\n                }\n            },\n            {\n                title: 'Giờ Đặt', dataIndex: 'NgayDat', key: 'GioDat', align: 'center',\n                render: (NgayDat) => {\n                    let GioDat = new Date(NgayDat)\n                    return (\n                        <span>{GioDat.toLocaleTimeString()}</span>\n                    )\n                }\n            }\n        ];\n\n        const data = this.props.profileInfor.ThongTinDatVe;\n\n        const columnsExpended = [\n            { title: 'Mã Vé', dataIndex: 'MaVe', key: 'MaVe', align: 'center', },\n            { title: 'Mã Ghế', dataIndex: 'MaGhe', key: 'MaGhe', align: 'center', },\n            { title: 'Tên Ghế', dataIndex: 'TenGhe', key: 'TenGhe', align: 'center', },\n            { title: 'Giá Vé', dataIndex: 'GiaVe', key: 'GiaVe', align: 'center', },\n            {\n                title: 'Chọn Hủy',\n                key: 'TrangThaiHuy',\n                align: 'center',\n                render: (record) => {\n                    let thoiGianChieu = (new Date(this.state.listTicket.NgayChieuGioChieu)).toLocaleDateString();\n                    let now = moment(new Date()).format(\"DD.MM.YYYY\"); //todays date\n                    let startDate = moment(thoiGianChieu, \"DD.MM.YYYY\");\n                    let endDate = moment(now, \"DD.MM.YYYY\");\n                    const duration = startDate.diff(endDate, 'days');\n                    console.log(duration);\n                    // disabled={duration <= 0 || record.TrangThaiHuy} onClick={() => { this.cancelTicket(duration, record.MaThanhToan) }}\n                    if (record.TrangThaiHuy) {\n\n                    }\n                    console.log(\"Switch\", record);\n\n                    return (\n                        <div>\n                            <Switch disabled={record.TrangThaiHuy || duration <= 1} onClick={() => this.cancelTicket(duration, record)} />\n                            {/* <Button className={\"button__title__icon \" + `${this.state.classTrangThaiVe}`} type=\"danger\" icon=\"delete\" size={\"small\"} onClick={() => {  }}> Cancel </Button> */}\n                        </div>\n                    )\n                },\n            },\n        ];\n\n        return (\n            <div>\n                <div className=\"profile__bg\">\n                    {/* <div className=\"coming__bg__overlay\"></div> */}\n                    <div className=\"container d-flex justify-content-between\" style={{ paddingTop: \"170px\" }}>\n                        <div className=\"profile__content\">\n                            <div className=\"border__bottom pb-4\" style={{ textAlign: \"center\" }}>\n                                <img src={process.env.PUBLIC_URL + \"/images/uploads/userava.png\"} alt=\"\" width={100} />\n                                <div className=\"mt-4\">\n                                    <Tag color=\"gold\" style={{ width: \"65px\", fontSize: \"14px\", fontWeight: \"bold\" }}>Edit</Tag>\n                                    <Tag color=\"gold\" style={{ width: \"65px\", fontSize: \"14px\", fontWeight: \"bold\" }}>Logout</Tag>\n                                </div>\n                            </div>\n\n                            <div className=\"d-flex justify-content-between my-4 border__bottom\">\n                                <span className=\"span__title__icon color-text\">\n                                    <Icon type=\"smile\" rotate={180} />\n                                    <span>&nbsp;&nbsp;Name</span>\n                                </span>\n                                <span>{profileInfor.HoTen}</span>\n                            </div>\n                            <div className=\"d-flex justify-content-between border__bottom my-4\">\n                                <span className=\"span__title__icon color-text\">\n                                    <Icon type=\"mail\" />\n                                    <span>&nbsp;&nbsp;Email</span>\n                                </span>\n                                <span>{profileInfor.Email}</span>\n                            </div>\n                            <div className=\"d-flex justify-content-between border__bottom my-4\">\n                                <span className=\"span__title__icon color-text\">\n                                    <Icon type=\"phone\" />\n                                    <span>&nbsp;&nbsp;Phone</span>\n                                </span>\n                                <span>{profileInfor.SoDT}</span>\n                            </div>\n                            <div className=\"d-flex justify-content-between border__bottom my-4\">\n                                <span className=\"span__title__icon color-text\">\n                                    <Icon type=\"crown\" />\n                                    <span>&nbsp;&nbsp;Membership</span>\n                                </span>\n                                <span>{profileInfor.LoaiNguoiDung}</span>\n\n                            </div>\n                            <div className=\"d-flex justify-content-between border__bottom my-4\">\n                                <span className=\"span__title__icon color-text\">\n                                    <Icon type=\"money-collect\" />\n                                    <span>&nbsp;&nbsp;Amount ticket</span>\n                                </span>\n                                <span className=\"color-text\">{profileInfor.SoLuongVeDaMua}</span>\n                            </div>\n                        </div>\n\n                        <div className=\"history__content\">\n                            <div className=\"\" style={{ float: \"right\", marginBottom: \"10px\" }}>\n                                <Tag color=\"#ed7532\" style={{ fontSize: \"16px\", padding: \"5px\" }}> <span className=\"span__title__icon\">\n                                    <Icon type=\"clock-circle\" />\n                                    <span>&nbsp;&nbsp;History booking</span>\n                                </span></Tag>\n                            </div>\n                            <Table\n                                bordered\n                                pagination={{\n                                    defaultPageSize: 3,\n                                }}\n                                rowKey={record => record.MaThanhToan}\n                                className=\"components-table-demo-nested\"\n                                columns={columns}\n                                onRow={(record) => ({\n                                    onDoubleClick: () => (this.handleOpenList(record)),\n                                })}\n                                // expandedRowRender={(record) =>\n                                //     <Table rowKey={(record) => record.MaVe} columns={columnsExpended} dataSource={record.DanhSachGhe} pagination={false} />\n                                // }\n                                dataSource={data}\n                            />\n                            <Modal className=\"modal__list__ticket\"\n                                title=\"List ticket booked\"\n                                visible={this.state.visible}\n                                // footer={false}\n                                okText=\"Send request cancel\"\n                                cancelText=\"Exit\"\n                                onOk={this.handleOk}\n                                onCancel={this.handleCancel}\n                            >\n                                <Table size='small' rowKey={(record) => record.MaVe} columns={columnsExpended} dataSource={this.state.listTicket.DanhSachGhe} pagination={false} />\n                            </Modal>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        profileInfor: state.MemberManageReducer.profileInfor,\n        setting: state.SettingReducer.setting,\n        danhSachVeDuocChon: state.BookingManageReducer.danhSachVeDuocChon\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        getProfile: (taiKhoan) => {\n            dispatch(getProFileAction(taiKhoan));\n        },\n        cancelTicket: (objectHuyVe) => {\n            dispatch(cancelTicketAction(objectHuyVe))\n        },\n        chonVeHuy: (veDangChon) => {\n            dispatch(huyVeAction(veDangChon))\n        },\n        getSetting: (setting) => {\n            dispatch(getSettingAction(setting))\n        }\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ProfileUser)"]},"metadata":{},"sourceType":"module"}