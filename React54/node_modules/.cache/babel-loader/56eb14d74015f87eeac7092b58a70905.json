{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Acer\\\\Desktop\\\\React54\\\\src\\\\pages\\\\BookingTicket\\\\BookingTicket.jsx\";\nimport React, { Component, Fragment } from 'react';\nimport { Redirect, withRouter, Prompt } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { getChiTietPhongVeAction, bookingTicketAction, putListGheDangDatAction, putDataInvokeAction } from '../../redux/actions/BookingManageAction';\nimport Seat from './Seat';\nimport { Modal, Spin, Radio } from 'antd';\nimport { settings } from '../../config/settings';\nimport { showMessageAlert, showMessageAlertEvent } from '../../templates/SweetAlert';\nimport { sendMailConfirmBooking } from '../../common/common';\nimport axios from 'axios';\nimport QRCode from 'qrcode'; // import base64url from 'base64-url'\n// import { connection } from '../../index'\n\nimport { PayPalButton } from \"react-paypal-button-v2\"; // import { TheaterSystemManageReducer } from '../../redux/reducers/TheaterSystemManageReducer';\n\nimport { getSettingAction } from '../../redux/actions/SettingAction';\nconst {\n  confirm\n} = Modal;\nconst perUSD = 0.000043;\n\nclass BookingTicket extends Component {\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n\n    this.startTime = () => {\n      this.setState({\n        isActive: true\n      });\n      this.countdown = setInterval(() => {\n        if (this.state.secondsElapsed === 0) {\n          clearInterval(this.countdown);\n        } else {\n          this.setState(({\n            secondsElapsed\n          }) => ({\n            secondsElapsed: secondsElapsed - 1\n          }));\n        }\n      }, 1000);\n    };\n\n    this.resetTime = () => {\n      clearInterval(this.countdown);\n      this.setState({\n        secondsElapsed: 1800000 / 1000,\n        isActive: false\n      });\n    };\n\n    this.pauseTime = () => {\n      clearInterval(this.countdown);\n      this.setState({\n        isActive: false\n      });\n    };\n\n    this.componentCleanup = () => {\n      // this will hold the cleanup code\n      // whatever you want to do when the component is unmounted or page refreshes\n      this._isMounted = false;\n      console.log('unmounting'); // clearInterval(this.myInterval)\n\n      if (localStorage.getItem(settings.userLogin)) {\n        let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan;\n        connection.invoke(\"SendRequestData\", taiKhoan, this.state.maLichChieu);\n      }\n    };\n\n    this.renderDanhSachGhe = () => {\n      return this.props.danhSachGhe.map((ds, index) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"tenHang\",\n            children: ds.TenHang\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 21\n          }, this), ds.DanhSachGheTheoHang.map((ghe, i) => {\n            return /*#__PURE__*/_jsxDEV(Seat, {\n              danhSachGheInvoke: this.state.danhSachGheInvoke,\n              maLichChieu: this.state.maLichChieu,\n              ghe: ghe,\n              index: i + 1,\n              tenHang: ghe.TenHang\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 36\n            }, this);\n          })]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 17\n        }, this);\n      });\n    };\n\n    this.renderGheDuocChon = () => {\n      return this.props.danhSachGheDaDat.map((gheDangDat, index) => {\n        return /*#__PURE__*/_jsxDEV(Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                color: \"#ec7532\"\n              },\n              children: gheDangDat.TenGhe\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 23\n            }, this), \" - \", gheDangDat.GiaVe.toLocaleString(), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \",\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 123\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 17\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 20\n        }, this);\n      });\n    };\n\n    this.handleBooking = () => {\n      let tongTien = 0; //Tạo object như backend yêu cầu điền đầy đủ thông tin vào các thuộc tính => gọi api thông qua action\n\n      this.props.danhSachGheDaDat.map((ghe, index) => {\n        return tongTien += ghe.GiaVe;\n      });\n      let objectDatVe = {\n        MaLichChieu: this.props.match.params.MaLichChieu,\n        TongTien: tongTien - tongTien * this.getValueUuDai() / 100,\n        GiamGia: tongTien * this.getValueUuDai() / 100,\n        DanhSachVe: this.props.danhSachGheDaDat,\n        TaiKhoan: JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan\n      };\n      let objectDSGheDangDat = {\n        maLichChieu: this.props.match.params.MaLichChieu,\n        danhSachGhe: JSON.stringify(this.props.danhSachGheDaDat),\n        taiKhoan: JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan\n      }; // this.props.putListGheDangDat(objectDSGheDangDat);\n\n      this.setState({\n        objectDatVe: objectDatVe\n      });\n\n      if (objectDatVe.DanhSachVe.length > 0) {\n        this.pauseTime();\n        let tongTien = 0;\n        {\n          this.props.danhSachGheDaDat.map((ghe, index) => {\n            return tongTien += ghe.GiaVe;\n          });\n        }\n        this.setState({\n          visiblePaypal: true,\n          danhSachVe: objectDatVe.DanhSachVe,\n          tongTien: tongTien\n        });\n      } else {\n        showMessageAlert('Note', 'Please choose seat!!!', 'warning');\n      }\n\n      console.log(\"objectDatVe\", objectDatVe); // Gọi hàm từ dispatch reducer đẩy giá trị này lên server\n      // this.props.datVeApi(objectDatVe);\n    };\n\n    this.handleOk = e => {\n      console.log(e);\n      let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan;\n      this.setState({\n        visible: false\n      });\n      connection.invoke(\"SendRequestData\", taiKhoan, this.state.maLichChieu);\n      window.location.reload();\n    };\n\n    this.handleCancel = e => {\n      console.log(e);\n      this.setState({\n        visible: false\n      });\n      this.props.history.push('/home/homepage');\n    };\n\n    this.handleCancelPaypal = e => {\n      this.startTime();\n      const {\n        minutes,\n        seconds\n      } = this.state;\n      this.setState({\n        visiblePaypal: false\n      });\n    };\n\n    this.onChangePayment = e => {\n      console.log('radio checked', e.target.value);\n      let objectDatVe = this.state.objectDatVe;\n      let objectDatVeNew = { ...objectDatVe,\n        TrangThaiThanhToan: e.target.value\n      };\n\n      if (e.target.value === 1) {\n        this.setState({\n          isOnlinePayment: true,\n          paymentStatus: e.target.value,\n          objectDatVe: objectDatVeNew\n        });\n        console.log(objectDatVeNew);\n      } else if (e.target.value === 0) {\n        this.setState({\n          isOnlinePayment: false,\n          paymentStatus: e.target.value\n        });\n        console.log(objectDatVeNew);\n      }\n    };\n\n    this.generateQR = async text => {\n      try {\n        console.log(await QRCode.toDataURL(text));\n      } catch (err) {\n        console.error(err);\n      }\n\n      await QRCode.toDataURL(text).then(url => {\n        return url;\n      });\n    };\n\n    this.getValueUuDai = () => {\n      if (this.state.flag) {\n        let giamGia = 0;\n        giamGia = this.props.setting.map(st => {\n          return st.Setting;\n        });\n        return giamGia;\n      } else return 0;\n    };\n\n    this.state = {\n      visible: true,\n      visiblePaypal: false,\n      danhSachVe: [],\n      objectDatVe: [],\n      tongTien: 0,\n      status: false,\n      maLichChieu: this.props.match.params.MaLichChieu,\n      minutes: 5,\n      seconds: 0,\n      isActive: false,\n      secondsElapsed: 90,\n      //time in seconds is 5 \n      // Send Email\n      feedback: '',\n      name: 'Name',\n      email: 'dreamstore2201@gmail.com',\n      content: '',\n      danhSachGheInvoke: [],\n      isOnlinePayment: false,\n      paymentStatus: 0,\n      isBookingButton: false,\n      giamGia: 0,\n      flag: false\n    };\n  }\n\n  getHours() {\n    return (\"0\" + Math.floor(this.state.secondsElapsed / 3600)).slice(-2);\n  }\n\n  getMinutes() {\n    return (\"0\" + Math.floor(this.state.secondsElapsed % 3600 / 60)).slice(-2);\n  }\n\n  getSeconds() {\n    return (\"0\" + this.state.secondsElapsed % 60).slice(-2);\n  }\n\n  componentDidMount() {\n    console.log('mounting'); // window.onbeforeunload = function (e) {\n    //     var message = \"Your confirmation message goes here.\",\n    //         e = e || window.event;\n    //     // For IE and Firefox\n    //     if (e) {\n    //         e.returnValue = message;\n    //     }\n    //     // For Safari\n    //     return message;\n    // };\n\n    this._isMounted = true;\n\n    if (this._isMounted) {\n      this.props.getChiTietPhongVe(this.state.maLichChieu);\n      localStorage.setItem('MaLichChieu', this.state.maLichChieu);\n      this.receiveListGheRealTime();\n      this.startTime();\n\n      if (localStorage.getItem(settings.userLogin) != null) {\n        this.getGiamGia();\n      }\n    }\n\n    window.addEventListener('beforeunload', this.componentCleanup);\n  } // static async getDerivedStateFromProps(nextProps, prevState) {\n  //     //  this.receiveListGheRealTime(); let tempArray = [];\n  //     let tempArray = [];\n  //     await connection.on(\"ReceiveListGheDangDat\", (dsGheDangDatReturn) => {\n  //         console.log(dsGheDangDatReturn, typeof (dsGheDangDatReturn));\n  //         tempArray = dsGheDangDatReturn.filter(item => item.maLichChieu === parseInt(prevState.maLichChieu));\n  //         console.log(\"tempArray\", tempArray);\n  //         // this.setState({\n  //         //     danhSachGheInvoke: tempArray\n  //         // })\n  //         nextProps.putDataInvoke(tempArray)\n  //     })\n  //     console.log(1);\n  //     return { ...prevState, danhSachGheInvoke: tempArray };\n  // }\n\n\n  componentWillUnmount() {\n    this.componentCleanup();\n    window.removeEventListener('beforeunload', this.componentCleanup);\n  } // Lấy % giảm giá\n\n\n  getGiamGia() {\n    let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin));\n\n    if (taiKhoan.MaLoaiThanhVien === 3) {\n      this.props.getSetting('GG1');\n      this.setState({\n        flag: true\n      });\n    }\n  }\n\n  receiveListGheRealTime() {\n    let tempArray = [];\n    connection.on(\"ReceiveListGheDangDat\", dsGheDangDatReturn => {\n      console.log(dsGheDangDatReturn, typeof dsGheDangDatReturn);\n      tempArray = dsGheDangDatReturn.filter(item => item.maLichChieu === parseInt(this.state.maLichChieu));\n      console.log(\"tempArray\", tempArray); // this.setState({\n      //     danhSachGheInvoke: tempArray\n      // })\n\n      this.props.putDataInvoke(tempArray);\n    });\n  }\n\n  createOrder(data, actions) {\n    let vndMoney = parseInt(this.state.tongTien);\n    let dataList = [];\n    this.props.danhSachGheDaDat.map((ghe, index) => {\n      let giaVe = ghe.GiaVe;\n      let item = {\n        name: 'Ghế ' + ghe.TenGhe,\n        unit_amount: {\n          value: giaVe,\n          currency_code: 'USD'\n        },\n        quantity: '1',\n        sku: ghe.GiaVe.toLocaleString() + ' VND'\n      };\n      dataList.push(item);\n    });\n    console.log(\"data\", data);\n    return actions.order.create({\n      intent: \"CAPTURE\",\n      purchase_units: [{\n        amount: {\n          value: vndMoney,\n          currency_code: 'USD',\n          breakdown: {\n            item_total: {\n              value: vndMoney,\n              currency_code: 'USD'\n            }\n          }\n        },\n        // invoice_id: 'muesli_invoice_id',\n        items: dataList\n      }]\n    });\n  }\n\n  onApprove(data, actions) {\n    // Capture the funds from the transaction\n    var objectDatVe = this.state.objectDatVe;\n    var danhSachGheDaDat = this.props.danhSachGheDaDat;\n    const {\n      thongTinPhim\n    } = this.props;\n    this.setState({\n      visiblePaypal: false\n    });\n    return actions.order.capture().then(function (details) {\n      // Show a success message to your buyer\n      // showMessageAlert(\"Notification\", \"Transaction completed by \" + details.payer.name.given_name, \"success\");\n      console.log('Notification', \"Transaction completed by \" + details.payer_given_name, 'success'); // OPTIONAL: Call your server to save the transaction\n\n      return axios({\n        url: settings.domainLocal + `/QuanLyDatVe/DatVe`,\n        method: 'POST',\n        data: objectDatVe,\n        headers: {\n          Authorization: 'Bearer ' + localStorage.getItem(settings.token)\n        }\n      }).then(result => {\n        // console.log(\"Ma Thanh Toan\", result.data);\n        if (result.data.Content === \"Tài khoản người dùng không tồn tại!\" || result.data.Content === \"Tài khoản người dùng không tồn tại!\") {\n          showMessageAlert('Warning', result.data.Content, 'warning');\n        } else if (isNaN(result.data)) {\n          console.log(\"Ma Thanh Toan\", result.data); // setTimeout(() => {\n          //     showMessageAlertEvent('Notification', 'Hãy kiểm tra email của bạn!', 'success')                        \n          // }, 3000);\n\n          console.log('danhSachGheDaDat', danhSachGheDaDat, 'result.data', result.data, 'this.getValueUuDai()', this.getValueUuDai());\n          sendMailConfirmBooking(danhSachGheDaDat, thongTinPhim, result.data, this.getValueUuDai());\n        }\n      }).catch(errors => {// console.log(errors.response.data);\n      });\n    });\n  }\n\n  sendFeedback(serviceID, templateID, templateParams, userID) {\n    window.emailjs.send(serviceID, templateID, templateParams, userID).then(res => {\n      console.log('Email successfully sent!');\n    }) // Handle errors here however you like, or use a React error boundary\n    .catch(err => console.error('Oh well, you failed. Here some thoughts on the error that occured:', err));\n  } // end handle email\n\n\n  async handlePaymentInCash() {\n    let objectDatVe = this.state.objectDatVe;\n    var danhSachGheDaDat = this.props.danhSachGheDaDat;\n    const {\n      thongTinPhim\n    } = this.props;\n    let objectDatVeNew = { ...objectDatVe,\n      TrangThaiThanhToan: 0\n    };\n    this.setState({\n      isBookingButton: true\n    });\n    console.log(objectDatVeNew);\n    await this.props.bookingTicket(objectDatVeNew);\n    setTimeout(() => {\n      console.log(this.props.datVeResult); // Kiểm tra kết quả đặt vé trước\n\n      sendMailConfirmBooking(danhSachGheDaDat, thongTinPhim, this.props.datVeResult, this.getValueUuDai());\n    }, 2000);\n  }\n\n  isEmpty(obj) {\n    for (var prop in obj) {\n      if (obj.hasOwnProperty(prop)) return false;\n    }\n\n    return true;\n  }\n\n  //PROMPT\n  // END PROMT\n  render() {\n    const {\n      minutes,\n      seconds\n    } = this.state;\n    const {\n      thongTinPhim\n    } = this.props;\n    let giamGia = 0;\n\n    if (!localStorage.getItem('userLogin')) {\n      return /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 454,\n        columnNumber: 20\n      }, this);\n    } // const doTuoiObj = JSON.parse(thongTinPhim.DoTuoi.toString());\n\n\n    const radioStyle = {\n      display: 'block',\n      height: '30px',\n      lineHeight: '30px'\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"booking__layout\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: this.props.danhSachGhe.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\",\n            children: /*#__PURE__*/_jsxDEV(Spin, {\n              size: \"large\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 468,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 467,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booking__content\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"seat__content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"seat__inner\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"seat__text d-flex justify-content-between\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"booking__infor d-flex align-items-center\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"booking__text text-white\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-animation\",\n                        children: [thongTinPhim.TenCumRap, \" \"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 479,\n                        columnNumber: 53\n                      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 479,\n                        columnNumber: 118\n                      }, this), thongTinPhim.NgayChieu, \" - \", thongTinPhim.GioChieu, \" - \", thongTinPhim.TenRap]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 478,\n                      columnNumber: 49\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 474,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"booking__watch text-white\",\n                    children: this.state.secondsElapsed === 0 ? /*#__PURE__*/_jsxDEV(Modal, {\n                      title: \"Time to hold a seat!\",\n                      visible: this.state.visible,\n                      onOk: this.handleOk,\n                      onCancel: this.handleCancel,\n                      okText: \"Book again\",\n                      children: /*#__PURE__*/_jsxDEV(\"p\", {\n                        children: \"Please fulfill your order within 5 minutes. \"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 493,\n                        columnNumber: 57\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 486,\n                      columnNumber: 53\n                    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: [\"Th\\u1EDDi gian gi\\u1EEF gh\\u1EBF \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 496,\n                        columnNumber: 76\n                      }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"countdown__timer\",\n                        children: [this.getMinutes(), \":\", this.getSeconds()]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 496,\n                        columnNumber: 83\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 496,\n                      columnNumber: 55\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 483,\n                    columnNumber: 45\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 473,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"mt-3 screen\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: process.env.PUBLIC_URL + '/images/screen.png',\n                    alt: \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 501,\n                    columnNumber: 45\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 500,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 472,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"m-4\",\n                children: this.renderDanhSachGhe()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"infor__booking_content\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"text-white border__bottom pb-4\",\n                children: thongTinPhim.TenPhim\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 511,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Ng\\xE0y chi\\u1EBFu gi\\u1EDD chi\\u1EBFu \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 514,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [thongTinPhim.NgayChieu, \" - \", /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      color: \"#ec7532\",\n                      fontSize: \"18px\"\n                    },\n                    children: thongTinPhim.GioChieu\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 515,\n                    columnNumber: 71\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 515,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 513,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom mt-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"C\\u1EE5m r\\u1EA1p \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 518,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: thongTinPhim.TenCumRap\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 519,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 517,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom mt-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"R\\u1EA1p \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 522,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: thongTinPhim.TenRap\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 523,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 521,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom mt-3 pb-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: \"30%\",\n                    textAlign: \"left\"\n                  },\n                  children: \"Gh\\u1EBF ch\\u1ECDn \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 526,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"content__gheDat\",\n                  style: {\n                    textAlign: \"left\"\n                  },\n                  children: this.renderGheDuocChon()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 527,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 525,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom mt-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"\\u01AFu \\u0111\\xE3i \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 533,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: [this.getValueUuDai(), \" %\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 534,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 532,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex justify-content-between border__bottom mt-3\",\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"T\\u1ED5ng ti\\u1EC1n \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 537,\n                  columnNumber: 41\n                }, this), this.props.danhSachGheDaDat.reduce((tongTien, ghe, index) => {\n                  return tongTien += ghe.GiaVe;\n                }, 0).toLocaleString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 536,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-4\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => this.handleBooking(),\n                  className: \"btn__booking\",\n                  children: \"Booking Ticket\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 543,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 542,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(Modal, {\n                title: \"Payment before booking !\",\n                visible: this.state.visiblePaypal,\n                onCancel: this.handleCancelPaypal,\n                footer: false,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  children: this.state.isBookingButton ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginTop: \"0\",\n                      textAlign: 'center'\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"lds-ellipsis-color\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 553,\n                        columnNumber: 164\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 553,\n                        columnNumber: 175\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 553,\n                        columnNumber: 186\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 553,\n                        columnNumber: 197\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 553,\n                      columnNumber: 128\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 553,\n                    columnNumber: 75\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(Radio.Group, {\n                      onChange: this.onChangePayment,\n                      value: this.state.paymentStatus,\n                      className: \"mb-4\",\n                      children: [/*#__PURE__*/_jsxDEV(Radio, {\n                        style: radioStyle,\n                        value: 0,\n                        children: \"Payment in cash\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 556,\n                        columnNumber: 57\n                      }, this), /*#__PURE__*/_jsxDEV(Radio, {\n                        style: radioStyle,\n                        value: 1,\n                        children: \"Payment online\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 559,\n                        columnNumber: 57\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 555,\n                      columnNumber: 53\n                    }, this), this.state.paymentStatus === 1 ? /*#__PURE__*/_jsxDEV(PayPalButton // clientId=\"Aasw_xwhD8mUqXIm0BIACYfAhlC4iogrojeWkKXPE8OSk32UFryNDcUqhE3E6IHlXcSOz3yuwicoYFUw\"\n                    , {\n                      createOrder: (data, actions) => this.createOrder(data, actions),\n                      onApprove: (data, actions) => this.onApprove(data, actions),\n                      onError: error => {\n                        console.log('error', error);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 564,\n                      columnNumber: 90\n                    }, this) : null, this.state.paymentStatus === 0 ? /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"btn__booking\",\n                      onClick: () => this.handlePaymentInCash(),\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: \"Continue\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 574,\n                        columnNumber: 163\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 574,\n                      columnNumber: 87\n                    }, this) : null]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 554,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 552,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 545,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 510,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"typeseat\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"gheNote\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 584,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gh\\u1EBF th\\u01B0\\u1EDDng\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 585,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"gheNote gheVip\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 588,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gh\\u1EBF VIP\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 589,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 587,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"gheNote gheDangDat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 592,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gh\\u1EBF \\u0111ang ch\\u1ECDn\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 593,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 591,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"gheNote gheDaDat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 596,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gh\\u1EBF \\u0111\\xE3 \\u0111\\u1EB7t\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 597,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 595,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"mr-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"gheNote diffUserChoosing\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 600,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Gh\\u1EBF \\u0111ang c\\xF3 ng\\u01B0\\u1EDDi ch\\u1ECDn\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 601,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 464,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    danhSachGhe: state.BookingManageReducer.danhSachGhe,\n    danhSachGheDaDat: state.BookingManageReducer.danhSachGheDaDat,\n    thongTinPhim: state.BookingManageReducer.thongTinPhim,\n    datVeResult: state.BookingManageReducer.datVeResult,\n    setting: state.SettingReducer.setting\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getChiTietPhongVe: maLichChieu => {\n      dispatch(getChiTietPhongVeAction(maLichChieu));\n    },\n    bookingTicket: objectDatVe => {\n      console.log(\"action\", objectDatVe);\n      dispatch(bookingTicketAction(objectDatVe));\n    },\n    putListGheDangDat: objectDSGheDangDat => {\n      console.log(\"objectDSGheDangDat\", objectDSGheDangDat);\n      dispatch(putListGheDangDatAction(objectDSGheDangDat));\n    },\n    putDataInvoke: objectDsGheDangChon => {\n      dispatch(putDataInvokeAction(objectDsGheDangChon));\n    },\n    getSetting: setting => {\n      dispatch(getSettingAction(setting));\n    }\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(BookingTicket));","map":{"version":3,"sources":["C:/Users/Acer/Desktop/React54/src/pages/BookingTicket/BookingTicket.jsx"],"names":["React","Component","Fragment","Redirect","withRouter","Prompt","connect","getChiTietPhongVeAction","bookingTicketAction","putListGheDangDatAction","putDataInvokeAction","Seat","Modal","Spin","Radio","settings","showMessageAlert","showMessageAlertEvent","sendMailConfirmBooking","axios","QRCode","PayPalButton","getSettingAction","confirm","perUSD","BookingTicket","constructor","props","_isMounted","startTime","setState","isActive","countdown","setInterval","state","secondsElapsed","clearInterval","resetTime","pauseTime","componentCleanup","console","log","localStorage","getItem","userLogin","taiKhoan","JSON","parse","TaiKhoan","connection","invoke","maLichChieu","renderDanhSachGhe","danhSachGhe","map","ds","index","TenHang","DanhSachGheTheoHang","ghe","i","danhSachGheInvoke","renderGheDuocChon","danhSachGheDaDat","gheDangDat","color","TenGhe","GiaVe","toLocaleString","handleBooking","tongTien","objectDatVe","MaLichChieu","match","params","TongTien","getValueUuDai","GiamGia","DanhSachVe","objectDSGheDangDat","stringify","length","visiblePaypal","danhSachVe","handleOk","e","visible","window","location","reload","handleCancel","history","push","handleCancelPaypal","minutes","seconds","onChangePayment","target","value","objectDatVeNew","TrangThaiThanhToan","isOnlinePayment","paymentStatus","generateQR","text","toDataURL","err","error","then","url","flag","giamGia","setting","st","Setting","status","feedback","name","email","content","isBookingButton","getHours","Math","floor","slice","getMinutes","getSeconds","componentDidMount","getChiTietPhongVe","setItem","receiveListGheRealTime","getGiamGia","addEventListener","componentWillUnmount","removeEventListener","MaLoaiThanhVien","getSetting","tempArray","on","dsGheDangDatReturn","filter","item","parseInt","putDataInvoke","createOrder","data","actions","vndMoney","dataList","giaVe","unit_amount","currency_code","quantity","sku","order","create","intent","purchase_units","amount","breakdown","item_total","items","onApprove","thongTinPhim","capture","details","payer_given_name","domainLocal","method","headers","Authorization","token","result","Content","isNaN","catch","errors","sendFeedback","serviceID","templateID","templateParams","userID","emailjs","send","res","handlePaymentInCash","bookingTicket","setTimeout","datVeResult","isEmpty","obj","prop","hasOwnProperty","render","radioStyle","display","height","lineHeight","TenCumRap","NgayChieu","GioChieu","TenRap","process","env","PUBLIC_URL","TenPhim","fontSize","width","textAlign","reduce","marginTop","mapStateToProps","BookingManageReducer","SettingReducer","mapDispatchToProps","dispatch","putListGheDangDat","objectDsGheDangChon"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react'\nimport { Redirect, withRouter, Prompt } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { getChiTietPhongVeAction, bookingTicketAction, putListGheDangDatAction, putDataInvokeAction } from '../../redux/actions/BookingManageAction';\nimport Seat from './Seat';\nimport { Modal, Spin, Radio, } from 'antd';\nimport { settings } from '../../config/settings';\nimport { showMessageAlert, showMessageAlertEvent } from '../../templates/SweetAlert';\nimport { sendMailConfirmBooking } from '../../common/common'\nimport axios from 'axios';\nimport QRCode from 'qrcode';\n// import base64url from 'base64-url'\n// import { connection } from '../../index'\n\nimport { PayPalButton } from \"react-paypal-button-v2\";\n// import { TheaterSystemManageReducer } from '../../redux/reducers/TheaterSystemManageReducer';\nimport { getSettingAction } from '../../redux/actions/SettingAction';\n\nconst { confirm } = Modal;\nconst perUSD = 0.000043\n\nclass BookingTicket extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            visible: true,\n            visiblePaypal: false,\n            danhSachVe: [],\n            objectDatVe: [],\n            tongTien: 0,\n            status: false,\n            maLichChieu: this.props.match.params.MaLichChieu,\n            minutes: 5,\n            seconds: 0,\n            isActive: false,\n            secondsElapsed: 90,//time in seconds is 5 \n            // Send Email\n            feedback: '', name: 'Name', email: 'dreamstore2201@gmail.com',\n            content: '',\n            danhSachGheInvoke: [],\n            isOnlinePayment: false,\n            paymentStatus: 0,\n            isBookingButton: false,\n            giamGia: 0,\n            flag: false\n        }\n    }\n\n    _isMounted = false;\n\n    getHours() {\n        return (\"0\" + Math.floor(this.state.secondsElapsed / 3600)).slice(-2);\n    }\n\n    getMinutes() {\n        return (\"0\" + Math.floor((this.state.secondsElapsed % 3600) / 60)).slice(\n            -2\n        );\n    }\n\n    getSeconds() {\n        return (\"0\" + (this.state.secondsElapsed % 60)).slice(-2);\n    }\n\n    startTime = () => {\n        this.setState({ isActive: true });\n\n        this.countdown = setInterval(() => {\n            if (this.state.secondsElapsed === 0) {\n                clearInterval(this.countdown);\n            }\n            else {\n                this.setState(({ secondsElapsed }) => ({\n                    secondsElapsed: secondsElapsed - 1\n                }));\n            }\n\n        }, 1000);\n\n    };\n\n    resetTime = () => {\n        clearInterval(this.countdown);\n        this.setState({\n            secondsElapsed: 1800000 / 1000,\n            isActive: false\n        });\n    };\n\n    pauseTime = () => {\n        clearInterval(this.countdown);\n        this.setState({ isActive: false });\n    };\n\n    componentDidMount() {\n        console.log('mounting');\n        // window.onbeforeunload = function (e) {\n        //     var message = \"Your confirmation message goes here.\",\n        //         e = e || window.event;\n        //     // For IE and Firefox\n        //     if (e) {\n        //         e.returnValue = message;\n        //     }\n        //     // For Safari\n        //     return message;\n        // };\n        this._isMounted = true;\n        if (this._isMounted) {\n            this.props.getChiTietPhongVe(this.state.maLichChieu);\n            localStorage.setItem('MaLichChieu', this.state.maLichChieu);\n            this.receiveListGheRealTime();\n\n            this.startTime();\n\n            if (localStorage.getItem(settings.userLogin) != null) {\n                this.getGiamGia();\n            }\n        }\n        window.addEventListener('beforeunload', this.componentCleanup);\n    }\n    // static async getDerivedStateFromProps(nextProps, prevState) {\n    //     //  this.receiveListGheRealTime(); let tempArray = [];\n    //     let tempArray = [];\n\n    //     await connection.on(\"ReceiveListGheDangDat\", (dsGheDangDatReturn) => {\n\n    //         console.log(dsGheDangDatReturn, typeof (dsGheDangDatReturn));\n    //         tempArray = dsGheDangDatReturn.filter(item => item.maLichChieu === parseInt(prevState.maLichChieu));\n    //         console.log(\"tempArray\", tempArray);\n    //         // this.setState({\n    //         //     danhSachGheInvoke: tempArray\n    //         // })\n    //         nextProps.putDataInvoke(tempArray)\n    //     })\n    //     console.log(1);\n    //     return { ...prevState, danhSachGheInvoke: tempArray };\n    // }\n\n    componentCleanup = () => { // this will hold the cleanup code\n        // whatever you want to do when the component is unmounted or page refreshes\n        this._isMounted = false;\n        console.log('unmounting');\n        // clearInterval(this.myInterval)\n        if (localStorage.getItem(settings.userLogin)) {\n            let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan;\n            connection.invoke(\"SendRequestData\", taiKhoan, this.state.maLichChieu);\n        }\n    }\n\n\n    componentWillUnmount() {\n        this.componentCleanup();\n        window.removeEventListener('beforeunload', this.componentCleanup);\n    }\n\n\n    // Lấy % giảm giá\n    getGiamGia() {\n        let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin));\n        if (taiKhoan.MaLoaiThanhVien === 3) {\n            this.props.getSetting('GG1');\n            this.setState({\n                flag: true\n            })\n        }\n    }\n\n\n    receiveListGheRealTime() {\n        let tempArray = [];\n        connection.on(\"ReceiveListGheDangDat\", (dsGheDangDatReturn) => {\n            console.log(dsGheDangDatReturn, typeof (dsGheDangDatReturn));\n            tempArray = dsGheDangDatReturn.filter(item => item.maLichChieu === parseInt(this.state.maLichChieu));\n            console.log(\"tempArray\", tempArray);\n            // this.setState({\n            //     danhSachGheInvoke: tempArray\n            // })\n            this.props.putDataInvoke(tempArray)\n        })\n    }\n\n\n    renderDanhSachGhe = () => {\n        return this.props.danhSachGhe.map((ds, index) => {\n            return (\n                <div className=\"d-flex\" key={index}>\n                    <span className=\"tenHang\">{ds.TenHang}</span>\n                    {\n                        ds.DanhSachGheTheoHang.map((ghe, i) => {\n                            return <Seat danhSachGheInvoke={this.state.danhSachGheInvoke} maLichChieu={this.state.maLichChieu} ghe={ghe} index={i + 1} tenHang={ghe.TenHang} key={i} />\n                        })\n                    }\n                    {/* {ghe[i].tenHang !== ghe[i--].tenHang ? <br /> : ''} */}\n                </div>\n            )\n        })\n    }\n\n    renderGheDuocChon = () => {\n        return this.props.danhSachGheDaDat.map((gheDangDat, index) => {\n            return <Fragment key={index}>\n                <span><span style={{ color: \"#ec7532\" }}>{gheDangDat.TenGhe}</span> - {gheDangDat.GiaVe.toLocaleString()} <span>,</span> </span>\n            </Fragment>\n        })\n    }\n\n    handleBooking = () => {\n        let tongTien = 0;\n        //Tạo object như backend yêu cầu điền đầy đủ thông tin vào các thuộc tính => gọi api thông qua action\n        this.props.danhSachGheDaDat.map((ghe, index) => {\n            return tongTien += ghe.GiaVe;\n        })\n        let objectDatVe = {\n            MaLichChieu: this.props.match.params.MaLichChieu,\n            TongTien: tongTien - tongTien*this.getValueUuDai()/100,\n            GiamGia: tongTien*this.getValueUuDai()/100,\n            DanhSachVe: this.props.danhSachGheDaDat,\n            TaiKhoan: JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan\n        }\n\n        let objectDSGheDangDat = {\n            maLichChieu: this.props.match.params.MaLichChieu,\n            danhSachGhe: JSON.stringify(this.props.danhSachGheDaDat),\n            taiKhoan: JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan\n        }\n\n        // this.props.putListGheDangDat(objectDSGheDangDat);\n\n        this.setState({\n            objectDatVe: objectDatVe\n        })\n        if (objectDatVe.DanhSachVe.length > 0) {\n            this.pauseTime();\n            let tongTien = 0;\n            {\n                this.props.danhSachGheDaDat.map((ghe, index) => {\n                    return tongTien += ghe.GiaVe;\n                })\n            }\n            this.setState({\n                visiblePaypal: true,\n                danhSachVe: objectDatVe.DanhSachVe,\n                tongTien: tongTien\n            })\n        }\n        else {\n            showMessageAlert('Note', 'Please choose seat!!!', 'warning')\n        }\n\n        console.log(\"objectDatVe\", objectDatVe);\n\n        // Gọi hàm từ dispatch reducer đẩy giá trị này lên server\n        // this.props.datVeApi(objectDatVe);\n    }\n\n    handleOk = e => {\n        console.log(e);\n        let taiKhoan = JSON.parse(localStorage.getItem(settings.userLogin)).TaiKhoan;\n        this.setState({\n            visible: false,\n        });\n        connection.invoke(\"SendRequestData\", taiKhoan, this.state.maLichChieu);\n        window.location.reload();\n    };\n\n    handleCancel = e => {\n        console.log(e);\n        this.setState({\n            visible: false,\n        });\n        this.props.history.push('/home/homepage');\n    };\n\n    handleCancelPaypal = e => {\n        this.startTime();\n        const { minutes, seconds } = this.state;\n        this.setState({\n            visiblePaypal: false\n        })\n    }\n\n\n    onChangePayment = e => {\n        console.log('radio checked', e.target.value);\n        let objectDatVe = this.state.objectDatVe;\n        let objectDatVeNew = {\n            ...objectDatVe,\n            TrangThaiThanhToan: e.target.value\n        }\n        if (e.target.value === 1) {\n            this.setState({\n                isOnlinePayment: true,\n                paymentStatus: e.target.value,\n                objectDatVe: objectDatVeNew\n            })\n            console.log(objectDatVeNew);\n        }\n        else if (e.target.value === 0) {\n            this.setState({\n                isOnlinePayment: false,\n                paymentStatus: e.target.value\n            })\n            console.log(objectDatVeNew);\n        }\n    };\n\n    createOrder(data, actions) {\n        let vndMoney = parseInt(this.state.tongTien);\n        let dataList = [];\n        this.props.danhSachGheDaDat.map((ghe, index) => {\n            let giaVe = ghe.GiaVe;\n            let item = {\n                name: 'Ghế ' + ghe.TenGhe,\n                unit_amount: {\n                    value: giaVe,\n                    currency_code: 'USD'\n                },\n                quantity: '1',\n                sku: ghe.GiaVe.toLocaleString() + ' VND'\n            }\n            dataList.push(item)\n        })\n        console.log(\"data\", data);\n        return actions.order.create({\n            intent: \"CAPTURE\",\n            purchase_units: [{\n                amount: {\n                    value: vndMoney,\n                    currency_code: 'USD',\n                    breakdown: {\n                        item_total: {\n                            value: vndMoney,\n                            currency_code: 'USD'\n                        }\n                    }\n                },\n                // invoice_id: 'muesli_invoice_id',\n                items: dataList\n            }]\n        });\n    }\n\n    onApprove(data, actions) {\n        // Capture the funds from the transaction\n        var objectDatVe = this.state.objectDatVe;\n        var danhSachGheDaDat = this.props.danhSachGheDaDat;\n        const { thongTinPhim } = this.props;\n        this.setState({\n            visiblePaypal: false\n        })\n        return actions.order.capture().then(function (details) {\n            // Show a success message to your buyer\n            // showMessageAlert(\"Notification\", \"Transaction completed by \" + details.payer.name.given_name, \"success\");\n            console.log('Notification', \"Transaction completed by \" + details.payer_given_name, 'success')\n            // OPTIONAL: Call your server to save the transaction\n            return axios({\n                url: settings.domainLocal + `/QuanLyDatVe/DatVe`,\n                method: 'POST',\n                data: objectDatVe,\n                headers: {\n                    Authorization: 'Bearer ' + localStorage.getItem(settings.token)\n                }\n            }).then((result) => {\n                // console.log(\"Ma Thanh Toan\", result.data);\n                if (result.data.Content === \"Tài khoản người dùng không tồn tại!\" || result.data.Content === \"Tài khoản người dùng không tồn tại!\") {\n                    showMessageAlert('Warning', result.data.Content, 'warning')\n                }\n                else if(isNaN(result.data)) {\n                    console.log(\"Ma Thanh Toan\", result.data);\n                    // setTimeout(() => {\n                    //     showMessageAlertEvent('Notification', 'Hãy kiểm tra email của bạn!', 'success')                        \n                    // }, 3000);\n                    console.log('danhSachGheDaDat', danhSachGheDaDat, 'result.data', result.data, 'this.getValueUuDai()', this.getValueUuDai());\n                    sendMailConfirmBooking(danhSachGheDaDat, thongTinPhim, result.data, this.getValueUuDai())\n                }\n\n            }).catch(errors => {\n                // console.log(errors.response.data);\n            })\n        });\n    }\n\n    generateQR = async text => {\n        try {\n            console.log(await QRCode.toDataURL(text))\n        } catch (err) {\n            console.error(err)\n        }\n        await QRCode.toDataURL(text).then((url) => {\n            return url;\n        });\n    }\n\n    sendFeedback(serviceID, templateID, templateParams, userID) {\n        window.emailjs.send(\n            serviceID, templateID,\n            templateParams,\n            userID\n        ).then(res => {\n            console.log('Email successfully sent!')\n        })\n            // Handle errors here however you like, or use a React error boundary\n            .catch(err => console.error('Oh well, you failed. Here some thoughts on the error that occured:', err))\n    }\n    // end handle email\n\n\n    async handlePaymentInCash() {\n        let objectDatVe = this.state.objectDatVe;\n        var danhSachGheDaDat = this.props.danhSachGheDaDat;\n        const { thongTinPhim } = this.props;\n        let objectDatVeNew = {\n            ...objectDatVe,\n            TrangThaiThanhToan: 0\n        }\n        this.setState({\n            isBookingButton: true,\n        })\n        console.log(objectDatVeNew);\n        await this.props.bookingTicket(objectDatVeNew);\n        setTimeout(() => {\n            console.log(this.props.datVeResult);\n            // Kiểm tra kết quả đặt vé trước\n            sendMailConfirmBooking(danhSachGheDaDat, thongTinPhim, this.props.datVeResult, this.getValueUuDai())\n        }, 2000);\n    }\n\n    isEmpty(obj) {\n        for(var prop in obj) {\n            if(obj.hasOwnProperty(prop))\n                return false;\n        }\n    \n        return true;\n    }\n\n    getValueUuDai = () => {\n        if (this.state.flag){  \n            let giamGia = 0;        \n            giamGia = this.props.setting.map(st => {\n                return st.Setting;\n            })\n            return giamGia;\n        }\n        else return 0;\n    }\n    //PROMPT\n    // END PROMT\n    render() {\n        const { minutes, seconds } = this.state;\n        const { thongTinPhim } = this.props;\n        let giamGia = 0;               \n        if (!localStorage.getItem('userLogin')) {\n            return <Redirect to='/' />\n        }\n        // const doTuoiObj = JSON.parse(thongTinPhim.DoTuoi.toString());\n        const radioStyle = {\n            display: 'block',\n            height: '30px',\n            lineHeight: '30px',\n        };\n        return (\n            <div className=\"booking__layout\">\n                <div className=\"container\">\n                    <div>\n                        {this.props.danhSachGhe.length === 0 ?\n                            <div className=\"spinner\">\n                                <Spin size=\"large\"></Spin>\n                            </div> :\n                            <div className=\"booking__content\">\n                                <div className=\"seat__content\">\n                                    <div className=\"seat__inner\">\n                                        <div className=\"seat__text d-flex justify-content-between\">\n                                            <div className=\"booking__infor d-flex align-items-center\">\n                                                {/* <div className=\"booking__logoHTR\">\n                                            <p>IMG</p>\n                                        </div> */}\n                                                <div className=\"booking__text text-white\">\n                                                    <span className=\"text-animation\">{thongTinPhim.TenCumRap} </span><br />\n                                                    {thongTinPhim.NgayChieu} - {thongTinPhim.GioChieu} - {thongTinPhim.TenRap}\n                                                </div>\n                                            </div>\n                                            <div className=\"booking__watch text-white\">\n                                                {this.state.secondsElapsed === 0\n                                                    ?\n                                                    <Modal\n                                                        title=\"Time to hold a seat!\"\n                                                        visible={this.state.visible}\n                                                        onOk={this.handleOk}\n                                                        onCancel={this.handleCancel}\n                                                        okText=\"Book again\"\n                                                    >\n                                                        <p>\n                                                            Please fulfill your order within 5 minutes. </p>\n                                                    </Modal>\n                                                    : <p>Thời gian giữ ghế <br /> <span className=\"countdown__timer\">{this.getMinutes()}:{this.getSeconds()}</span></p>\n                                                }\n                                            </div>\n                                        </div>\n                                        <div className=\"mt-3 screen\">\n                                            <img src={process.env.PUBLIC_URL + '/images/screen.png'} alt=\"\" />\n                                        </div>\n                                    </div>\n                                    <div className=\"m-4\">\n\n                                        {this.renderDanhSachGhe()}\n\n                                    </div>\n                                </div>\n                                <div className=\"infor__booking_content\">\n                                    <h4 className=\"text-white border__bottom pb-4\">{thongTinPhim.TenPhim}</h4>\n                                    {/* <p>{(thongTinPhim.DoTuoi)}</p> */}\n                                    <div className=\"d-flex justify-content-between border__bottom\">\n                                        <p>Ngày chiếu giờ chiếu </p>\n                                        <p>{thongTinPhim.NgayChieu} - <span style={{ color: \"#ec7532\", fontSize: \"18px\" }}>{thongTinPhim.GioChieu}</span></p>\n                                    </div>\n                                    <div className=\"d-flex justify-content-between border__bottom mt-3\">\n                                        <p>Cụm rạp </p>\n                                        <p>{thongTinPhim.TenCumRap}</p>\n                                    </div>\n                                    <div className=\"d-flex justify-content-between border__bottom mt-3\">\n                                        <p>Rạp </p>\n                                        <p>{thongTinPhim.TenRap}</p>\n                                    </div>\n                                    <div className=\"d-flex justify-content-between border__bottom mt-3 pb-3\">\n                                        <div style={{ width: \"30%\", textAlign: \"left\" }}>Ghế chọn </div>\n                                        <div className=\"content__gheDat\" style={{ textAlign: \"left\" }}>\n                                            {this.renderGheDuocChon()}\n                                        </div>\n                                        {/* <br/> */}\n                                    </div>\n                                    <div className=\"d-flex justify-content-between border__bottom mt-3\">\n                                        <p>Ưu đãi </p>\n                                        <p>{this.getValueUuDai()} %</p>\n                                    </div>\n                                    <div className=\"d-flex justify-content-between border__bottom mt-3\">\n                                        <p>Tổng tiền </p>\n                                        {this.props.danhSachGheDaDat.reduce((tongTien, ghe, index) => {\n                                            return tongTien += ghe.GiaVe;\n                                        }, 0).toLocaleString()}\n                                    </div>\n                                    <div className=\"mt-4\">\n                                        <button onClick={() => this.handleBooking()} className=\"btn__booking\" >Booking Ticket</button>\n                                    </div>\n                                    <Modal\n                                        title=\"Payment before booking !\"\n                                        visible={this.state.visiblePaypal}\n                                        onCancel={this.handleCancelPaypal}\n                                        footer={false}\n                                    >\n                                        {/* Thanh toán trực tuyến và thanh toán online */}\n                                        <div>\n                                            {this.state.isBookingButton ? <div style={{ marginTop: \"0\", textAlign: 'center' }}><div className=\"lds-ellipsis-color\"><div></div><div></div><div></div><div></div></div></div> :\n                                                <div>\n                                                    <Radio.Group onChange={this.onChangePayment} value={this.state.paymentStatus} className=\"mb-4\">\n                                                        <Radio style={radioStyle} value={0}>\n                                                            Payment in cash\n                                                        </Radio>\n                                                        <Radio style={radioStyle} value={1}>\n                                                            Payment online\n                                                        </Radio>\n                                                    </Radio.Group>\n                                                    {\n                                                        this.state.paymentStatus === 1 ? <PayPalButton\n                                                            // clientId=\"Aasw_xwhD8mUqXIm0BIACYfAhlC4iogrojeWkKXPE8OSk32UFryNDcUqhE3E6IHlXcSOz3yuwicoYFUw\"\n                                                            createOrder={(data, actions) => this.createOrder(data, actions)}\n                                                            onApprove={(data, actions) => this.onApprove(data, actions)}\n                                                            onError={(error) => {\n                                                                console.log('error', error);\n                                                            }}\n                                                        /> : null\n                                                    }\n                                                    {/* Button dành cho thanh toán tiền mặt */}\n                                                    {this.state.paymentStatus === 0 ? <button className=\"btn__booking\" onClick={() => this.handlePaymentInCash()}><span>Continue</span></button> : null}\n                                                </div>}\n                                        </div>\n                                    </Modal>\n                                </div>\n                            </div>\n                        }\n                    </div>\n                    <div className=\"typeseat\">\n                        <span className=\"mr-2\">\n                            <button className=\"gheNote\"></button>\n                            <span>Ghế thường</span>\n                        </span>\n                        <span className=\"mr-2\">\n                            <button className=\"gheNote gheVip\"></button>\n                            <span>Ghế VIP</span>\n                        </span>\n                        <span className=\"mr-2\">\n                            <button className=\"gheNote gheDangDat\"></button>\n                            <span>Ghế đang chọn</span>\n                        </span >\n                        <span className=\"mr-2\">\n                            <button className=\"gheNote gheDaDat\"></button>\n                            <span>Ghế đã đặt</span>\n                        </span>\n                        <span className=\"mr-2\">\n                            <button className=\"gheNote diffUserChoosing\"></button>\n                            <span>Ghế đang có người chọn</span>\n                        </span>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        danhSachGhe: state.BookingManageReducer.danhSachGhe,\n        danhSachGheDaDat: state.BookingManageReducer.danhSachGheDaDat,\n        thongTinPhim: state.BookingManageReducer.thongTinPhim,\n        datVeResult: state.BookingManageReducer.datVeResult,\n        setting: state.SettingReducer.setting\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        getChiTietPhongVe: (maLichChieu) => {\n            dispatch(getChiTietPhongVeAction(maLichChieu));\n        },\n        bookingTicket: (objectDatVe) => {\n            console.log(\"action\", objectDatVe);\n            dispatch(bookingTicketAction(objectDatVe));\n        },\n        putListGheDangDat: (objectDSGheDangDat) => {\n            console.log(\"objectDSGheDangDat\", objectDSGheDangDat);\n            dispatch(putListGheDangDatAction(objectDSGheDangDat));\n        },\n        putDataInvoke: (objectDsGheDangChon) => {\n            dispatch(putDataInvokeAction(objectDsGheDangChon))\n        },\n        getSetting: (setting) => {\n            dispatch(getSettingAction(setting))\n        }\n    }\n}\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(BookingTicket))"]},"metadata":{},"sourceType":"module"}